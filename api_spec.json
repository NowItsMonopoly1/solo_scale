{"openapi":"3.0.0","info":{"title":"SoloScale API","description":"Multi-tenant mortgage automation platform","version":"1.0.0"},"components":{"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}},"schemas":{}},"paths":{"/auth/register":{"post":{"tags":["Auth"],"description":"Register new user account","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","password","name"],"properties":{"email":{"type":"string","format":"email"},"password":{"type":"string","minLength":8},"name":{"type":"string","minLength":2},"accountName":{"type":"string"}}}}},"required":true},"responses":{"201":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"role":{"type":"string"},"accountId":{"type":"string"}}}}}}}}}}},"/auth/login":{"post":{"tags":["Auth"],"description":"Login with email and password","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string","format":"email"},"password":{"type":"string"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string"},"user":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"string"},"role":{"type":"string"},"accountId":{"type":"string"}}}}}}}},"401":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}}}}}}}}},"/auth/me":{"get":{"responses":{"200":{"description":"Default Response"}}}},"/accounts/{accountId}/conversations":{"post":{"summary":"Create a new conversation","tags":["Conversations"],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"lead_id":{"type":"string","format":"uuid"},"realtor_id":{"type":"string","format":"uuid"},"subject":{"type":"string"}}}}}},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"accountId","required":true}],"responses":{"201":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"status":{"type":"string"}}}}}}}},"get":{"summary":"List conversations","tags":["Conversations"],"parameters":[{"schema":{"type":"string","enum":["active","closed","archived"]},"in":"query","name":"status","required":false},{"schema":{"type":"string","format":"uuid"},"in":"query","name":"lead_id","required":false},{"schema":{"type":"number","minimum":1,"maximum":100},"in":"query","name":"limit","required":false},{"schema":{"type":"number","minimum":0},"in":"query","name":"offset","required":false},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"accountId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/conversations/{id}":{"get":{"summary":"Get conversation details","tags":["Conversations"],"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"accountId","required":true},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/conversations/{id}/close":{"post":{"summary":"Close a conversation","tags":["Conversations"],"description":"Closes the conversation and generates an AI summary of the interaction","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"close_reason":{"type":"string"}}}}}},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"accountId","required":true},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/conversations/{id}/reopen":{"post":{"summary":"Reopen a closed conversation","tags":["Conversations"],"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"accountId","required":true},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/{accountId}/conversations/history":{"get":{"summary":"Get conversation history","tags":["Conversations"],"description":"Retrieve all closed conversations","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"lead_id","required":false},{"schema":{"type":"number","minimum":1,"maximum":100},"in":"query","name":"limit","required":false},{"schema":{"type":"number","minimum":0},"in":"query","name":"offset","required":false},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"accountId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/conversations/{id}/messages":{"post":{"summary":"Add a message to a conversation","tags":["Conversations"],"requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["direction","channel","body"],"properties":{"direction":{"type":"string","enum":["inbound","outbound"]},"channel":{"type":"string","enum":["sms","email"]},"from_number":{"type":"string"},"to_number":{"type":"string"},"from_email":{"type":"string","format":"email"},"to_email":{"type":"string","format":"email"},"subject":{"type":"string"},"body":{"type":"string"},"ai_generated":{"type":"boolean"}}}}},"required":true},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"query","name":"accountId","required":true},{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/{accountId}/leads/":{"get":{"tags":["leads"],"description":"Get all leads for authenticated account","parameters":[{"schema":{"type":"string","enum":["new","in_progress","qualified","closed","lost"]},"in":"query","name":"status","required":false,"description":"Filter by lead status"},{"schema":{"type":"number","minimum":1,"maximum":100,"default":50},"in":"query","name":"limit","required":false,"description":"Number of leads to return"},{"schema":{"type":"number","minimum":0,"default":0},"in":"query","name":"offset","required":false,"description":"Pagination offset"},{"schema":{"type":"string","enum":["urgency","retirement_priority","created_at"],"default":"retirement_priority"},"in":"query","name":"sort","required":false,"description":"Sort field"},{"schema":{"type":"string","enum":["asc","desc"],"default":"desc"},"in":"query","name":"order","required":false,"description":"Sort order"},{"schema":{"type":"string"},"in":"path","name":"accountId","required":true}],"responses":{"200":{"description":"Default Response"}}},"post":{"tags":["leads"],"description":"Create new lead","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["name","email","source"],"properties":{"name":{"type":"string","minLength":1,"maxLength":255},"email":{"type":"string","format":"email"},"phone":{"type":"string","maxLength":20},"source":{"type":"string","maxLength":100},"status":{"type":"string","enum":["new","in_progress","qualified","closed","lost"],"default":"new"},"loan_amount":{"type":"number","minimum":0},"credit_tier":{"type":"string","enum":["excellent","good","fair","poor","unknown"]},"ssn_last_4":{"type":"string","pattern":"^[0-9]{4}$"},"retirement_priority_score":{"type":"number","minimum":0,"maximum":100},"assigned_to_user_id":{"type":"string"},"tags":{"type":"array","items":{"type":"string"}}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"accountId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/{accountId}/leads/{id}":{"get":{"tags":["leads"],"description":"Get lead by ID","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true,"description":"Lead ID"}],"responses":{"200":{"description":"Default Response"}}},"put":{"tags":["leads"],"description":"Update lead","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","minLength":1,"maxLength":255},"email":{"type":"string","format":"email"},"phone":{"type":"string","maxLength":20},"status":{"type":"string","enum":["new","in_progress","qualified","closed","lost"]},"loan_amount":{"type":"number","minimum":0},"credit_tier":{"type":"string","enum":["excellent","good","fair","poor","unknown"]},"retirement_priority_score":{"type":"number","minimum":0,"maximum":100},"assigned_to_user_id":{"type":"string"},"next_follow_up_date":{"type":"string","format":"date-time"},"tags":{"type":"array","items":{"type":"string"}}}}}}},"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}},"delete":{"tags":["leads"],"description":"Delete lead","parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/{accountId}/workflows/":{"get":{"parameters":[{"schema":{"type":"string"},"in":"path","name":"accountId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/accounts/{accountId}/templates/":{"get":{"parameters":[{"schema":{"type":"string"},"in":"path","name":"accountId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/api/messaging/send-sms":{"post":{"tags":["messaging"],"description":"Send SMS via Twilio","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["to","message"],"properties":{"to":{"type":"string","description":"Recipient phone number (E.164 format, e.g., +14155551234)","pattern":"^\\+[1-9]\\d{1,14}$"},"message":{"type":"string","description":"SMS message body (max 1600 chars)","maxLength":1600},"from":{"type":"string","description":"Override sender phone number (optional)"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"sid":{"type":"string","description":"Twilio message SID"},"status":{"type":"string","description":"Delivery status"},"message":{"type":"string","description":"Success message"}}}}}}}}},"/api/messaging/send-email":{"post":{"tags":["messaging"],"description":"Send email via SendGrid","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["to","subject","body"],"properties":{"to":{"type":"string","description":"Recipient email address","format":"email"},"subject":{"type":"string","description":"Email subject line","maxLength":500},"body":{"type":"string","description":"Email body (plain text)"},"html":{"type":"string","description":"Email body (HTML, optional)"},"from":{"type":"string","description":"Override sender email (optional)","format":"email"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"messageId":{"type":"string","description":"SendGrid message ID"},"message":{"type":"string","description":"Success message"}}}}}}}}},"/api/messaging/create-chaser":{"post":{"tags":["messaging"],"description":"Create automated follow-up chaser","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["leadId","chaserType","reason"],"properties":{"leadId":{"type":"string","description":"Lead ID to chase"},"chaserType":{"type":"string","enum":["sms","email","both"],"description":"Type of chaser to send"},"reason":{"type":"string","description":"Reason for chaser (e.g., \"Missing Year-to-Date income\")","maxLength":500},"templateId":{"type":"string","description":"Message template ID (optional)"},"customTemplate":{"type":"string","description":"Custom message template (optional)"},"scheduledAt":{"type":"string","format":"date-time","description":"When to send chaser (ISO 8601 format, optional, defaults to now)"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"chaserId":{"type":"string","description":"Created chaser ID"},"message":{"type":"string","description":"Success message"}}}}}}}}},"/api/messaging/templates":{"get":{"tags":["messaging"],"description":"Get all message templates for account","responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"templates":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"name":{"type":"string"},"description":{"type":"string"},"category":{"type":"string"},"body":{"type":"string"},"variables":{"type":"array","items":{"type":"string"}},"usage_count":{"type":"number"}}}}}}}}}}}},"/api/messaging/process-chasers":{"post":{"tags":["messaging"],"description":"Manually trigger pending chaser processing (admin only)","responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"sent":{"type":"number","description":"Number of chasers sent"},"failed":{"type":"number","description":"Number of chasers failed"},"message":{"type":"string"}}}}}}}}},"/api/partners/team/overview":{"get":{"tags":["partners"],"description":"Get team overview for senior partner","responses":{"200":{"description":"Default Response"}}}},"/api/partners/team/brokers":{"get":{"tags":["partners"],"description":"Get all junior brokers reporting to senior partner","responses":{"200":{"description":"Default Response"}}}},"/api/partners/performance":{"get":{"tags":["partners"],"description":"Get partner performance metrics","parameters":[{"schema":{"type":"string"},"in":"query","name":"user_id","required":false,"description":"User ID to get performance for"},{"schema":{"type":"string","format":"date"},"in":"query","name":"period_start","required":false,"description":"Start date (YYYY-MM-DD)"},{"schema":{"type":"string","format":"date"},"in":"query","name":"period_end","required":false,"description":"End date (YYYY-MM-DD)"}],"responses":{"200":{"description":"Default Response"}}}},"/api/partners/reassignment/pending":{"get":{"tags":["partners"],"description":"Get leads that need reassignment due to inactivity","responses":{"200":{"description":"Default Response"}}}},"/api/partners/reassignment/process":{"post":{"tags":["partners"],"description":"Process all pending lead reassignments (admin/cron only)","responses":{"200":{"description":"Default Response"}}}},"/api/partners/reassignment/{leadId}":{"post":{"tags":["partners"],"description":"Manually reassign a lead to another user","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["target_user_id"],"properties":{"target_user_id":{"type":"string","description":"User ID to reassign lead to"},"reason":{"type":"string","description":"Reason for reassignment"}}}}},"required":true},"parameters":[{"schema":{"type":"string"},"in":"path","name":"leadId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/api/partners/activity/{leadId}":{"get":{"tags":["partners"],"description":"Get activity history for a specific lead","parameters":[{"schema":{"type":"string"},"in":"path","name":"leadId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/api/system/health-report":{"post":{"tags":["System"],"description":"Send weekly system health report via email","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["recipientEmail"],"properties":{"recipientEmail":{"type":"string","format":"email"},"accountId":{"type":"string","format":"uuid"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}}}}},"/api/system/health-metrics":{"get":{"tags":["System"],"description":"Get current system health metrics","responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"metrics":{"type":"string"},"generatedAt":{"type":"string"}}}}}}}}},"/documents/api/documents/process":{"post":{"tags":["Documents"],"description":"Queue document for AI extraction (background processing)","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["leadId","fileData","mimeType"],"properties":{"leadId":{"type":"string"},"fileData":{"type":"string","description":"Base64-encoded file"},"mimeType":{"type":"string","enum":["application/pdf","image/jpeg","image/png"]},"expectedBorrowerName":{"type":"string"},"clientName":{"type":"string"},"brokerName":{"type":"string"},"clientPhone":{"type":"string"},"clientEmail":{"type":"string","format":"email"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean"},"jobId":{"type":"string"},"message":{"type":"string"},"statusUrl":{"type":"string"}}}}}}}}},"/documents/api/documents/status/{jobId}":{"get":{"tags":["Documents"],"description":"Get document processing job status","parameters":[{"schema":{"type":"string"},"in":"path","name":"jobId","required":true}],"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"jobId":{"type":"string"},"status":{"type":"string","enum":["waiting","active","completed","failed"]},"progress":{"type":"number"},"result":{"type":"object","additionalProperties":true},"error":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"processedAt":{"type":"string","format":"date-time"}}}}}}}}},"/documents/api/documents/history/{leadId}":{"get":{"tags":["Documents"],"description":"Get document extraction history for a lead","parameters":[{"schema":{"type":"string"},"in":"path","name":"leadId","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/documents/api/documents/batch-process":{"post":{"tags":["Documents"],"description":"Queue multiple documents for batch processing","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["documents"],"properties":{"documents":{"type":"array","items":{"type":"object","required":["leadId","fileData","mimeType"],"properties":{"leadId":{"type":"string"},"fileData":{"type":"string"},"mimeType":{"type":"string"},"expectedBorrowerName":{"type":"string"},"clientName":{"type":"string"},"brokerName":{"type":"string"},"clientPhone":{"type":"string"},"clientEmail":{"type":"string"}}},"maxItems":50}}}}},"required":true},"responses":{"200":{"description":"Default Response"}}}},"/api/ai/extract-document":{"post":{"tags":["AI"],"description":"Extract mortgage data from document using AI","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["fileData","mimeType"],"properties":{"fileData":{"type":"string","description":"Base64 encoded file data"},"mimeType":{"type":"string","description":"File MIME type (e.g., application/pdf, image/jpeg)"},"expectedBorrowerName":{"type":"string","description":"Expected borrower name for discrepancy detection"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"document_type":{"type":"string"},"key_entities":{"type":"object"},"discrepancy_alerts":{"type":"array"},"extraction_confidence":{"type":"number"},"raw_text_preview":{"type":"string"}}}}}}}}},"/api/ai/extract-general-document":{"post":{"tags":["AI"],"description":"Extract data from general documents (paystub, W-2, bank statement, etc.)","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["fileData","mimeType","documentType"],"properties":{"fileData":{"type":"string","description":"Base64 encoded file data"},"mimeType":{"type":"string","description":"File MIME type"},"documentType":{"type":"string","enum":["paystub","w2","bank_statement","1003","tax_return","other"],"description":"Type of document to extract"}}}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"extracted_data":{"type":"object"},"confidence":{"type":"number"},"document_type":{"type":"string"},"warnings":{"type":"array","items":{"type":"string"}}}}}}}}}},"/api/ai/chat":{"post":{"tags":["AI"],"description":"Chat with AI Speed Agent","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["history","message"],"properties":{"history":{"type":"array","items":{"type":"object","properties":{"role":{"type":"string"},"parts":{"type":"array","items":{"type":"object","properties":{"text":{"type":"string"}}}}}}},"message":{"type":"string"},"modelToUse":{"type":"string"}}}}},"required":true},"responses":{"200":{"description":"Default Response"}}}},"/api/ai/analyze-lead-urgency":{"post":{"tags":["AI"],"description":"Analyze lead urgency using AI","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["content","rawSource"],"properties":{"content":{"type":"string"},"rawSource":{"type":"string"},"reasoningModel":{"type":"string"}}}}},"required":true},"responses":{"200":{"description":"Default Response"}}}},"/api/ai/generate-chaser-sms":{"post":{"tags":["AI"],"description":"Generate automated chaser SMS","requestBody":{"content":{"application/json":{"schema":{"type":"object","required":["clientName","brokerName","missingField"],"properties":{"clientName":{"type":"string"},"brokerName":{"type":"string"},"missingField":{"type":"string"}}}}},"required":true},"responses":{"200":{"description":"Default Response"}}}},"/conversations/{id}/messages":{"get":{"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/integrations/floify/webhook":{"post":{"responses":{"200":{"description":"Default Response"}}}},"/integrations/salesforce/webhook":{"post":{"responses":{"200":{"description":"Default Response"}}}},"/health":{"get":{"responses":{"200":{"description":"Default Response"}}}}},"servers":[{"url":"http://localhost:8080","description":"Development server"}]}